import React, { useEffect, useState } from 'react';
import styles from '../assets/css/TodayEmotion.module.css';
import { useTodoQuery } from '../api/useQuery';
import { format } from 'date-fns';
import { useNavigate } from 'react-router-dom';
export default function TodayEmotion({ todo }) {
  const navigate = useNavigate();
  const today = format(new Date(), 'yyyy.M.d');
  const { data: diary } = useTodoQuery(today, 'diary');
  const [todayDiary, setTodayDiary] = useState();
  useEffect(() => {
    diary && setTodayDiary(diary.filter(item => item.createdAt === today)[0]);
  }, [diary, todo]);

  return (
    <>
      {todayDiary ? (
        <button
          onClick={() => navigate(`/diary/list`)}
          className={styles.btnDiary}>
          <img
            className={styles.status}
            src={`${process.env.PUBLIC_URL}/images/${todayDiary.status}.png`}
          />
        </button>
      ) : (
        <button
          className={styles.addEmotion}
          onClick={() => navigate('/diary/create', { state: new Date() })}>
          <svg
            width="37"
            height="35"
            viewBox="0 0 37 35"
            fill="none"
            xmlns="http://www.w3.org/2000/svg">
            <path
              d="M21.035 19.463C21.035 20.1171 20.9454 20.7132 20.766 21.2513C20.5972 21.7894 20.3387 22.2536 19.9906 22.6439C19.6424 23.0238 19.2151 23.3192 18.7087 23.5302C18.2023 23.7306 17.6167 23.8309 16.9521 23.8309C16.2663 23.8309 15.6649 23.7254 15.148 23.5143C14.6415 23.3033 14.2195 23.0079 13.8819 22.6281C13.5443 22.2378 13.2911 21.7788 13.1223 21.2513C12.9535 20.7132 12.8691 20.1171 12.8691 19.463H14.3409C14.3409 20.1277 14.4305 20.7027 14.6099 21.188C14.7998 21.6733 15.0899 22.0479 15.4803 22.3116C15.8707 22.5754 16.3612 22.7072 16.9521 22.7072C17.5534 22.7072 18.044 22.5754 18.4238 22.3116C18.8142 22.0479 19.0991 21.6733 19.2784 21.188C19.4683 20.7027 19.5633 20.1277 19.5633 19.463H21.035Z"
              fill="#3F72AF"
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M15.9862 2C15.6781 2 15.3725 2.00995 15.0696 2.02952L14.9407 0.033682C15.2864 0.011337 15.6351 0 15.9862 0C16.3374 0 16.686 0.011337 17.0318 0.0336821L16.9028 2.02952C16.6 2.00995 16.2943 2 15.9862 2ZM13.2556 2.26624C12.6516 2.38571 12.0618 2.54406 11.4887 2.73856L10.8459 0.844661C11.5017 0.622092 12.1766 0.440922 12.8674 0.304261L13.2556 2.26624ZM20.4838 2.73856C19.9107 2.54406 19.3208 2.38571 18.7169 2.26624L19.105 0.304261C19.7958 0.440922 20.4707 0.622092 21.1265 0.844661L20.4838 2.73856ZM9.79952 3.43901C9.25043 3.71031 8.7216 4.01665 8.21597 4.35517L7.10333 2.69323C7.68112 2.30641 8.28564 1.95619 8.91359 1.64593L9.79952 3.43901ZM23.7565 4.35517C23.2509 4.01665 22.722 3.71031 22.1729 3.43901L23.0589 1.64593C23.6868 1.95619 24.2913 2.30641 24.8691 2.69323L23.7565 4.35517ZM6.76469 5.47037C6.30567 5.87323 5.87323 6.30567 5.47037 6.76469L3.96721 5.44541C4.42731 4.92117 4.92117 4.42731 5.44541 3.9672L6.76469 5.47037ZM26.5021 6.76469C26.0992 6.30567 25.6668 5.87323 25.2078 5.47037L26.527 3.96721C27.0513 4.42731 27.5451 4.92117 28.0053 5.44541L26.5021 6.76469ZM4.35517 8.21596C4.01665 8.7216 3.71031 9.25042 3.43901 9.79951L1.64593 8.91358C1.95619 8.28564 2.30641 7.68112 2.69323 7.10332L4.35517 8.21596ZM28.5334 9.79952C28.2621 9.25043 27.9558 8.7216 27.6173 8.21597L29.2792 7.10333C29.666 7.68112 30.0163 8.28564 30.3265 8.91359L28.5334 9.79952ZM2.73856 11.4887C2.54406 12.0618 2.38571 12.6516 2.26624 13.2556L0.304261 12.8674C0.440922 12.1766 0.622092 11.5017 0.844661 10.8459L2.73856 11.4887ZM29.7062 13.2556C29.5867 12.6516 29.4284 12.0618 29.2339 11.4887L31.1278 10.8459C31.3504 11.5017 31.5315 12.1766 31.6682 12.8674L29.7062 13.2556ZM2.02952 15.0696C2.00995 15.3725 2 15.6781 2 15.9862C2 16.2943 2.00995 16.5999 2.02952 16.9028L0.033682 17.0318C0.011337 16.686 0 16.3374 0 15.9862C0 15.6351 0.011337 15.2864 0.0336821 14.9407L2.02952 15.0696ZM29.9725 15.9862C29.9725 15.6781 29.9625 15.3725 29.9429 15.0696L31.9388 14.9407C31.9611 15.2864 31.9725 15.6351 31.9725 15.9862H29.9725ZM2.26624 18.7169C2.38571 19.3208 2.54406 19.9107 2.73856 20.4838L0.844661 21.1265C0.622092 20.4707 0.440922 19.7958 0.304261 19.105L2.26624 18.7169ZM3.43901 22.1729C3.71031 22.722 4.01665 23.2509 4.35517 23.7565L2.69323 24.8691C2.30641 24.2913 1.95619 23.6868 1.64593 23.0589L3.43901 22.1729ZM5.47037 25.2078C5.87323 25.6668 6.30567 26.0992 6.76469 26.5021L5.44541 28.0053C4.92117 27.5451 4.42731 27.0513 3.9672 26.527L5.47037 25.2078ZM8.21596 27.6173C8.7216 27.9558 9.25042 28.2621 9.79951 28.5334L8.91358 30.3265C8.28564 30.0163 7.68112 29.666 7.10332 29.2792L8.21596 27.6173ZM11.4887 29.2339C12.0618 29.4284 12.6516 29.5867 13.2556 29.7062L12.8674 31.6682C12.1766 31.5315 11.5017 31.3504 10.8459 31.1278L11.4887 29.2339ZM15.0696 29.9429C15.3725 29.9625 15.6781 29.9725 15.9862 29.9725V31.9725C15.6351 31.9725 15.2864 31.9611 14.9407 31.9388L15.0696 29.9429Z"
              fill="#3F72AF"
            />
            <path
              fillRule="evenodd"
              clipRule="evenodd"
              d="M27.7879 34C31.7878 34 35.0303 30.7575 35.0303 26.7576C35.0303 22.7577 31.7878 19.5152 27.7879 19.5152C23.788 19.5152 20.5455 22.7577 20.5455 26.7576C20.5455 30.7575 23.788 34 27.7879 34ZM27.7879 35C32.34 35 36.0303 31.3097 36.0303 26.7576C36.0303 22.2054 32.34 18.5152 27.7879 18.5152C23.2357 18.5152 19.5455 22.2054 19.5455 26.7576C19.5455 31.3097 23.2357 35 27.7879 35Z"
              fill="#3F72AF"
            />
            <path
              d="M31.5344 27.0018C31.5344 27.132 31.5206 27.2064 31.493 27.225C31.4745 27.2436 31.4008 27.2529 31.2718 27.2529H28.2856V30.2669C28.2856 30.3878 28.2764 30.4576 28.2579 30.4762C28.2395 30.4948 28.1704 30.5041 28.0506 30.5041H27.5114C27.3916 30.5041 27.3224 30.4948 27.304 30.4762C27.2856 30.4576 27.2764 30.3878 27.2764 30.2669V27.2529H24.304C24.175 27.2529 24.0966 27.2436 24.069 27.225C24.0505 27.2064 24.0413 27.132 24.0413 27.0018V26.4994C24.0413 26.3692 24.0505 26.2948 24.069 26.2762C24.0966 26.2576 24.175 26.2483 24.304 26.2483H27.2764V23.2622C27.2764 23.1319 27.2856 23.0575 27.304 23.0389C27.3317 23.0203 27.41 23.011 27.539 23.011H28.0229C28.1519 23.011 28.2257 23.0203 28.2441 23.0389C28.2718 23.0575 28.2856 23.1319 28.2856 23.2622V26.2483H31.2718C31.4008 26.2483 31.4745 26.2576 31.493 26.2762C31.5206 26.2948 31.5344 26.3692 31.5344 26.4994V27.0018Z"
              fill="#3F72AF"
            />
            <path
              d="M11.5503 14.1879C11.5503 14.9162 10.9599 15.5067 10.2315 15.5067C9.50318 15.5067 8.91273 14.9162 8.91273 14.1879C8.91273 13.4595 9.50318 12.8691 10.2315 12.8691C10.9599 12.8691 11.5503 13.4595 11.5503 14.1879Z"
              fill="#3F72AF"
            />
            <path
              d="M23.4194 14.1879C23.4194 14.9162 22.8289 15.5067 22.1006 15.5067C21.3723 15.5067 20.7818 14.9162 20.7818 14.1879C20.7818 13.4595 21.3723 12.8691 22.1006 12.8691C22.8289 12.8691 23.4194 13.4595 23.4194 14.1879Z"
              fill="#3F72AF"
            />
          </svg>
        </button>
      )}
    </>
  );
}
